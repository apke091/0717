<nav class="navbar navbar-light bg-light px-3 fixed-top shadow-sm">
  <!-- 漢堡按鈕 -->
  <button class="btn btn-outline-secondary" type="button" data-bs-toggle="offcanvas" data-bs-target="#sideMenu" aria-controls="sideMenu">
    ☰
  </button>

  <!-- 品牌名稱 -->
  <a class="navbar-brand ms-2 text-decoration-none text-dark" href="{{ url_for('index') }}">
    大台南芳薰香植物精油服務人員職業工會
  </a>

  <!-- 右側：使用者 -->
  <div class="ms-auto d-flex align-items-center gap-2">
    {% if session.get("username") %}
      <span class="me-2 text-secondary">👋 Dear. {{ session.get('username') }}</span>
      <a href="{{ url_for('change_password') }}" class="btn btn-outline-secondary btn-sm">改密碼</a>
      <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm">登出</a>
    {% else %}
      <a href="{{ url_for('login') }}" class="btn btn-outline-success btn-sm">登入</a>
      <a href="{{ url_for('register') }}" class="btn btn-outline-primary btn-sm">註冊</a>
    {% endif %}
  </div>
</nav>

<!-- 左側 Offcanvas -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="sideMenu" aria-labelledby="sideMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sideMenuLabel">MENU</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>

  <div class="offcanvas-body">
    <!-- 一般導覽 -->
    <ul class="nav flex-column mb-3">
      <li class="nav-item"><a class="nav-link" href="{{ url_for('index') }}">首頁</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('about') }}">關於本會</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('news') }}">最新資訊</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('downloads') }}">下載專區</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('rent') }}">教室租借</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('contact') }}">聯絡我們</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('shop') }}">精油商城</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('video_gallery') }}">影音專區</a></li>
    </ul>

    {% if session.get("username") %}
      <hr>
      <!-- 購物車 -->
      <ul class="nav flex-column mb-3">
        <li class="nav-item">
  <a class="nav-link d-inline-flex align-items-center" href="{{ url_for('cart') }}" id="cartLink">
    🛒 購物車
    {% if (cart_count|int) > 0 %}
      <span class="ms-1 cart-badge">{{ (cart_count|int) if (cart_count|int) <= 99 else '99+' }}</span>
    {% endif %}
  </a>
</li>


      </ul>
    {% endif %}

    {% if session.get('role') == 'admin' %}
      <hr>
      <!-- 綜合管理 -->
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center"
             data-bs-toggle="collapse" href="#adminMenu" role="button"
             aria-expanded="false" aria-controls="adminMenu">
            綜合管理
            <span class="arrow">&#9656;</span> <!-- ▶ -->
          </a>
          <div class="collapse ps-2" id="adminMenu">
            <ul class="nav flex-column admin-submenu">
              <li class="nav-item"><a class="nav-link" href="{{ url_for('manage_users') }}">帳號管理</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('manage_products') }}">商品管理</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('manage_rents') }}">確認租借資訊</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('upload_file') }}">上傳檔案</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('upload_video') }}">上傳影片</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('edit_about') }}">關於我們（編輯）</a></li>
            </ul>
          </div>
        </li>
      </ul>
    {% endif %}
  </div>
</div>

<!-- CSS -->
<style>
  .arrow {
    transition: transform 0.2s ease;
  }
  .nav-link[aria-expanded="true"] .arrow {
    transform: rotate(90deg); /* ▶ 轉 ▼ */
  }

 /* 1️⃣ 管理子選單字體顏色改成灰色 */
.admin-submenu .nav-link {
  color: #6c757d !important;  /* 灰色字 */
  padding: 5px 15px;
}
.admin-submenu .nav-link:hover {
  background-color: #e9ecef; /* hover 時淺灰底 */
  color: #000; /* hover 時字變黑 */
  border-radius: 3px;
}

/* 2️⃣ Offcanvas 關閉按鈕背景顏色 */
.offcanvas .btn-close {
  background-color: #dee2e6;   /* 淡灰色背景 */
  border-radius: 50%;          /* 圓形背景 */
  opacity: 1;                  /* 確保顯示 */
}
.offcanvas .btn-close:hover {
  background-color: #cce5ff;   /* hover 時淡藍色 */
}


  /* ✅ 漢堡選單藍色字 hover 效果 */
  .offcanvas-body .nav-link {
    color: blue;
    text-decoration: none;
    display: block;
    padding: 8px 12px;
    border-radius: 5px;
  }
  .offcanvas-body .nav-link:hover {
    background-color: #e9ecef; /* 灰色背景 */
    color: blue;               /* 文字保持藍色 */
  }
</style>
