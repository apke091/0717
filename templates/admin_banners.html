{% extends "base.html" %}
{% block title %}Banner ç®¡ç†{% endblock %}
{% block content %}
<div class="container" style="margin-top:90px;max-width:1100px">

  <div class="d-flex align-items-center justify-content-between mb-3">
    <h3 class="m-0">ğŸ¯ Banner ç®¡ç†</h3>
    <a href="{{ url_for('index') }}" target="_blank" class="btn btn-outline-secondary">é è¦½é¦–é </a>
  </div>

  <!-- æ–°å¢ -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h5 class="card-title mb-3">æ–°å¢ Banner</h5>
      <form method="post" enctype="multipart/form-data" class="row g-3">
        <input type="hidden" name="action" value="create">
        <div class="col-md-4">
          <label class="form-label">åœ–ç‰‡ï¼ˆå»ºè­° 1920Ã—650ï¼‰</label>
          <input type="file" name="image" class="form-control" accept=".jpg,.jpeg,.png,.webp" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">æ¨™é¡Œï¼ˆå¯ç©ºï¼‰</label>
          <input type="text" name="title" class="form-control">
        </div>
        <div class="col-md-4">
          <label class="form-label">å‰¯æ¨™ï¼ˆå¯ç©ºï¼‰</label>
          <input type="text" name="subtitle" class="form-control">
        </div>
        <div class="col-md-6">
          <label class="form-label">é€£çµï¼ˆ/shop æˆ– httpâ€¦ï¼‰</label>
          <input type="text" name="link" class="form-control" placeholder="/shop">
        </div>
        <div class="col-md-3">
          <label class="form-label">å¾½ç« ï¼ˆå¯ç©ºï¼Œå¦‚ NEWï¼‰</label>
          <input type="text" name="badge" class="form-control" placeholder="NEW">
        </div>
        <div class="col-md-3 d-grid">
          <label class="form-label invisible">æäº¤</label>
          <button class="btn btn-primary">+ æ–°å¢</button>
        </div>
      </form>
    </div>
  </div>

  <!-- åˆ—è¡¨ -->
  <div class="row g-3">
    {% for b in banners %}
    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="ratio" style="--bs-aspect-ratio:34%;">
          <img src="{{ url_for('static', filename='hero/' ~ b.img) }}" class="w-100 h-100" style="object-fit:cover">
        </div>
        <div class="card-body">
          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center gap-2">
              {% if b.badge %}<span class="badge bg-secondary">{{ b.badge }}</span>{% endif %}
              <strong class="fs-5">{{ b.title or 'ï¼ˆç„¡æ¨™é¡Œï¼‰' }}</strong>
            </div>
            <small class="text-muted">é †åºï¼š{{ loop.index }}</small>
          </div>
          <div class="text-muted mt-1">{{ b.subtitle }}</div>
          {% if b.link %}<div class="small mt-1"><code>{{ b.link }}</code></div>{% endif %}

          <hr>

          <!-- æ’åº & åˆªé™¤ -->
          <div class="d-flex gap-2 mb-3">
            <form method="post">
              <input type="hidden" name="action" value="move_up">
              <input type="hidden" name="id" value="{{ b.id }}">
              <button class="btn btn-outline-secondary btn-sm" {% if loop.first %}disabled{% endif %}>â¬†ï¸ ä¸Šç§»</button>
            </form>
            <form method="post">
              <input type="hidden" name="action" value="move_down">
              <input type="hidden" name="id" value="{{ b.id }}">
              <button class="btn btn-outline-secondary btn-sm" {% if loop.last %}disabled{% endif %}>â¬‡ï¸ ä¸‹ç§»</button>
            </form>
            <form method="post" onsubmit="return confirm('ç¢ºå®šè¦åˆªé™¤ï¼Ÿæ­¤å‹•ä½œæœƒåŒæ™‚åˆªé™¤åœ–ç‰‡æª”ã€‚')">
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="id" value="{{ b.id }}">
              <button class="btn btn-outline-danger btn-sm">ğŸ—‘ï¸ åˆªé™¤</button>
            </form>
          </div>

          <!-- ç·¨è¼¯æ–‡å­— -->
          <form method="post" class="row g-2">
            <input type="hidden" name="action" value="edit_text">
            <input type="hidden" name="id" value="{{ b.id }}">
            <div class="col-md-6">
              <label class="form-label small">æ¨™é¡Œ</label>
              <input type="text" name="title" class="form-control form-control-sm" value="{{ b.title }}">
            </div>
            <div class="col-md-6">
              <label class="form-label small">å¾½ç« </label>
              <input type="text" name="badge" class="form-control form-control-sm" value="{{ b.badge }}">
            </div>
            <div class="col-12">
              <label class="form-label small">å‰¯æ¨™</label>
              <input type="text" name="subtitle" class="form-control form-control-sm" value="{{ b.subtitle }}">
            </div>
            <div class="col-12">
              <label class="form-label small">é€£çµ</label>
              <input type="text" name="link" class="form-control form-control-sm" value="{{ b.link }}">
            </div>
            <div class="col-12 d-flex justify-content-end">
              <button class="btn btn-primary btn-sm mt-2">å„²å­˜æ–‡å­—</button>
            </div>
          </form>

          <!-- æ›åœ– -->
          <form method="post" enctype="multipart/form-data" class="mt-3">
            <input type="hidden" name="action" value="replace_image">
            <input type="hidden" name="id" value="{{ b.id }}">
            <div class="input-group input-group-sm">
              <input type="file" name="image" class="form-control" accept=".jpg,.jpeg,.png,.webp" required>
              <button class="btn btn-outline-primary">æ›åœ–</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  {% if banners|length == 0 %}
  <div class="text-center text-muted my-5">ç›®å‰æ²’æœ‰ Bannerï¼Œè«‹å…ˆæ–°å¢ã€‚</div>
  {% endif %}

</div>
{% endblock %}
