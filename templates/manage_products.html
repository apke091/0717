{% extends "base.html" %}
{% block title %}å•†å“ç®¡ç†{% endblock %}

{% block content %}
<div class="container" style="margin-top: 90px">
  <h2>ğŸ“¦ å•†å“ç®¡ç†</h2>

  <!-- æ–°å¢å•†å“è¡¨å–® -->
  <div class="card p-3 mb-4" style="max-width: 600px;">
    <h5 class="card-title mb-3">æ–°å¢å•†å“</h5>
    <form method="POST">
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="pid" class="form-label">å•†å“ ID</label>
          <input type="text" class="form-control" name="pid" id="pid" required>
        </div>
        <div class="col-md-4">
          <label for="name" class="form-label">åç¨±</label>
          <input type="text" class="form-control" name="name" id="name" required>
        </div>
        <div class="col-md-4">
          <label for="price" class="form-label">åƒ¹æ ¼</label>
          <input type="number" class="form-control" name="price" id="price" min="0" required>
        </div>
      </div>
      <button type="submit" class="btn btn-success">æ–°å¢å•†å“</button>
    </form>
  </div>

  <!-- å•†å“æ¸…å–® -->
  <h5>å•†å“åˆ—è¡¨</h5>
  <div class="table-responsive">
    <table class="table table-bordered table-striped align-middle">
      <thead class="table-light">
        <tr>
          <th style="width:120px;">å•†å“ ID</th>
          <th>åç¨±</th>
          <th style="width:160px;">åƒ¹æ ¼</th>
          <th style="width:200px;">æ“ä½œ</th>
        </tr>
      </thead>
      <tbody>
      {% for p in products %}
        <tr>
          <td class="text-muted">{{ p["pid"] }}</td>

          <!-- å°±åœ°ç·¨è¼¯è¡¨å–®ï¼ˆåç¨±ï¼‹åƒ¹æ ¼ï¼‰ -->
          <td>
            <form class="d-flex gap-2 align-items-center"
                  method="POST"
                  action="{{ url_for('update_product', pid=p['pid']) }}">
              <input name="name"
                     class="form-control form-control-sm"
                     value="{{ p['name'] }}"
                     required>
          </td>
          <td>
              <input name="price"
                     type="number"
                     min="0"
                     class="form-control form-control-sm text-end"
                     value="{{ p['price'] }}"
                     required>
          </td>
          <td>
              <button class="btn btn-primary btn-sm me-2">å„²å­˜</button>
            </form>

            <!-- åˆªé™¤ï¼ˆç¨ç«‹è¡¨å–®é¿å…åµŒå¥—ï¼‰ -->
            <form class="d-inline"
                  method="POST"
                  action="{{ url_for('delete_product', pid=p['pid']) }}"
                  onsubmit="return confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å•†å“å—ï¼Ÿ')">
              <button class="btn btn-danger btn-sm">åˆªé™¤</button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
